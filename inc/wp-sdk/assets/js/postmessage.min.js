(function(e,t){var s=this;s.FS=s.FS||{};s.FS.PostMessage=function(){var s=false,n=new NoJQueryPostMessageMixin("postMessage","receiveMessage"),o={},i,r=decodeURIComponent(document.location.hash.replace(/^#/,"")),a=r.substring(0,r.indexOf("/","https://"===r.substring(0,"https://".length)?8:7)),c=function(){n.receiveMessage(function(e){var t=JSON.parse(e.data);if(o[t.type]){for(var s=0;s<o[t.type].length;s++){o[t.type][s](t.data)}}},i)},u=""!==r,p=e(window),g=e("html");return{init:function(e,t){i=e;c();FS.PostMessage.receiveOnce("forward",function(e){window.location=e.url});t=t||[];if(t.length>0){p.on("scroll",function(){for(var e=0;e<t.length;e++){FS.PostMessage.postScroll(t[e])}})}},init_child:function(){this.init(a);s=true;e(window).bind("load",function(){FS.PostMessage.postHeight();FS.PostMessage.post("loaded")})},hasParent:function(){return u},postHeight:function(t,s){t=t||0;s=s||"#wrap_section";this.post("height",{height:t+e(s).outerHeight(true)})},postScroll:function(e){this.post("scroll",{top:p.scrollTop(),height:p.height()-parseFloat(g.css("paddingTop"))-parseFloat(g.css("marginTop"))},e)},post:function(e,t,s){console.debug("PostMessage.post",e);if(s){n.postMessage(JSON.stringify({type:e,data:t}),s.src,s.contentWindow)}else{n.postMessage(JSON.stringify({type:e,data:t}),r,window.parent)}},receive:function(e,s){console.debug("PostMessage.receive",e);if(t===o[e])o[e]=[];o[e].push(s)},receiveOnce:function(e,t){if(this.is_set(e))return;this.receive(e,t)},is_set:function(e){return t!=o[e]},parent_url:function(){return r},parent_subdomain:function(){return a}}}()})(jQuery);